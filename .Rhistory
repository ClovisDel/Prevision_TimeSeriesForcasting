knitr::opts_chunk$set(echo = TRUE)
#install for export in pdf file
#tinytex::install_tinytex()
if(!require(forecast)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(forecast)
if(!require(fpp2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(fpp2)
if(!require(MLmetrics)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(MLmetrics)
library(ggplot2)
library(fpp2)
library(MLmetrics)
data <- read.csv("Trafic-voyageurs.csv", sep=";")
summary(data)
data_value <- data[,2]
data_ts <- ts(data_value, start=2011, frequency=12)
#plot(data_ts)
autoplot(data_ts) + ggtitle("Série chronologique Trafic voyageurs") +
ylab("Nbr voyageurs")
#revoir l affichage car ca prend pas en compte tt 2019
data_ts_train <- window(data_ts, start = c(2011, 1), end = c(2018,12))
data_ts_test <- window(data_ts, start= c(2019,1), end = c(2019,8))
data_ts_train
data_ts_test
plot(data_ts, xlim=c(2011,2020))
lines(data_ts_test, col=3)
legend("topleft", lty = 1, col=c(1,3), legend=c("Série chronologique Train", "Série chronologique Test"))
ggseasonplot(data_ts)
data_ts_without_trend = diff(data_ts)
ggseasonplot(data_ts_without_trend)
decomposed_data <- decompose(data_ts_train, type="additive")
plot(decomposed_data$trend)
plot(decomposed_data$seasonal)
plot(decomposed_data$random)
boxplot(data_ts ~ cycle(data_ts))
checkresiduals(remainder(decomposed_data))
library(forecast)
mean <- meanf(data_ts_train, h=8)
naivem <- naive(data_ts_train, h=8)
driftm <- rwf(data_ts_train, h=8, drif=T)
snaivem <- snaive(data_ts_train, h=8)
plot(mean, plot.conf = F, main="")
lines(naivem$mean, col=2, lty=1)
lines(driftm$mean, col=5, lty=1)
lines(snaivem$mean, col = 4, lty=1)
legend("topleft", lty=1, col=c(1,2,3,4), legend=c("Mean Method", "Naive Method", "Drif Method", "Seasonal Naive"))
#comparaison :
plot(snaivem, plot.conf = F, main="")
lines(data_ts_test, col = 6, lty=1, lwd=3)
plot(driftm, plot.conf = F, main="")
lines(data_ts_test, col = 6, lty=1, lwd=3)
print(summary(mean))
checkresiduals(mean)
accuracy(mean, data_ts_test)
print(summary(naivem))
checkresiduals(naivem)
accuracy(naivem, data_ts_test)
print(summary(driftm))
checkresiduals(driftm)
accuracy(driftm, data_ts_test)
print(summary(snaivem))
checkresiduals(snaivem)
accuracy(snaivem, data_ts_test)
fcst_se <- ses(data_ts_train, h = 8)
print(summary(fcst_se))
checkresiduals(fcst_se)
plot(fcst_ets)
plot(fcst_ets)
plot(fcst_se)
lines(data_ts_test, col="red")
df_se = as.data.frame(fcst_se)
predict_value_se <- df_se$`Point Forecast`
MAPE(predict_value_se, data_ts_test)*100
fit_ets <- ets(data_ts_train)
print(summary(fit_ets))
checkresiduals(fit_ets)
fcst_ets <- forecast(fit_ets, h=8)
plot(fcst_ets)
lines(data_ts_test, col="red")
df_ets = as.data.frame(fcst_ets)
predict_value_ets = df_ets$`Point Forecast`
MAPE(predict_value_ets, data_ts_test)*100
# retourne les meilleurs paramètres
# d=1 enleve la tendance
# D=1 enleve la saisonnalité
# => avoir des données stationnaires
# trace : voir les résultats
fit_arima <- auto.arima(data_ts_train, d=1, D=1, stepwise = FALSE, approximation = FALSE, trace=TRUE)
print(summary(fit_arima))
checkresiduals(fit_arima)
fcst_arima <- forecast(fit_arima, h=8)
plot(fcst_arima)
lines(data_ts_test, col='red')
df_arima = as.data.frame(fcst_arima)
predict_value_arima = df_arima$`Point Forecast`
MAPE(predict_value_arima, data_ts_test)*100
knitr::opts_chunk$set(echo = TRUE)
source("Fonctions.R", local = knitr::knit_global())
#install for export in pdf file
#tinytex::install_tinytex()
if(!require(forecast)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(forecast)
if(!require(fpp2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(fpp2)
if(!require(MLmetrics)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(MLmetrics)
if(!require(ggplot2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(ggplot2)
if(!require(fpp2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(fpp2)
library(readr)
data <- read_delim("Trafic-voyageurs.csv",
delim = ";", locale = locale(encoding = "ISO-8859-1"))
summary(data)
data_value <- data[,2]
data_ts <- ts(data_value, start=2011, frequency=12)
plot_1_TimeSeries(data_ts)
knitr::opts_chunk$set(echo = TRUE)
source("Fonctions.R", local = knitr::knit_global())
#install for export in pdf file
#tinytex::install_tinytex()
if(!require(forecast)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(forecast)
if(!require(fpp2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(fpp2)
if(!require(MLmetrics)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(MLmetrics)
if(!require(ggplot2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(ggplot2)
if(!require(fpp2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(fpp2)
if(!require(TSstudio)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(TSstudio)
library(readr)
data <- read_delim("Trafic-voyageurs.csv",
delim = ";", locale = locale(encoding = "ISO-8859-1"))
summary(data)
data_value <- data[,2]
data_ts <- ts(data_value, start=2011, frequency=12)
plot_1_TimeSeries(data_ts)
library(TSstudio)
library(TSstudio)
knitr::opts_chunk$set(echo = TRUE)
source("Fonctions.R", local = knitr::knit_global())
#install for export in pdf file
#tinytex::install_tinytex()
if(!require(forecast)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(forecast)
if(!require(fpp2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(fpp2)
if(!require(MLmetrics)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(MLmetrics)
if(!require(ggplot2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(ggplot2)
if(!require(fpp2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(fpp2)
if(!require(TSstudio)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(TSstudio)
library(readr)
data <- read_delim("Trafic-voyageurs.csv",
delim = ";", locale = locale(encoding = "ISO-8859-1"))
summary(data)
data_value <- data[,2]
library(TSstudio)
knitr::opts_chunk$set(echo = TRUE)
source("Fonctions.R", local = knitr::knit_global())
#install for export in pdf file
#tinytex::install_tinytex()
if(!require(forecast)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(forecast)
if(!require(fpp2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(fpp2)
if(!require(MLmetrics)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(MLmetrics)
if(!require(ggplot2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(ggplot2)
if(!require(fpp2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(fpp2)
if(!require(TSstudio)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(TSstudio)
library(readr)
data <- read_delim("Trafic-voyageurs.csv",
delim = ";", locale = locale(encoding = "ISO-8859-1"))
summary(data)
data_value <- data[,2]
library(TSstudio)
install.packages("TSstudio")
knitr::opts_chunk$set(echo = TRUE)
source("Fonctions.R", local = knitr::knit_global())
#install for export in pdf file
#tinytex::install_tinytex()
if(!require(forecast)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(forecast)
if(!require(fpp2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(fpp2)
if(!require(MLmetrics)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(MLmetrics)
if(!require(ggplot2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(ggplot2)
if(!require(fpp2)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(fpp2)
if(!require(TSstudio)) install.packages("tm", repos = "http://cran.us.r-project.org")
require(TSstudio)
library(readr)
data <- read_delim("Trafic-voyageurs.csv",
delim = ";", locale = locale(encoding = "ISO-8859-1"))
summary(data)
data_value <- data[,2]
library(TSstudio)
data_ts <- ts(data_value, start=2011, frequency=12)
plot_1_TimeSeries(data_ts)
#revoir l affichage car ca prend pas en compte tt 2019
data_ts_train <- window(data_ts, start = c(2011, 1), end = c(2018,12))
data_ts_test <- window(data_ts, start= c(2019,1), end = c(2019,8))
plot(data_ts, xlim=c(2011,2020))
lines(data_ts_test, col=3)
legend("topleft", lty = 1, col=c(1,3), legend=c("Série chronologique Train", "Série chronologique Test"))
ggseasonplot(data_ts)
data_ts_without_trend = diff(data_ts)
ggseasonplot(data_ts_without_trend)
decomposed_data <- decompose(data_ts_train, type="additive")
plot(decomposed_data$trend)
plot(decomposed_data$seasonal)
plot(decomposed_data$random)
boxplot(data_ts ~ cycle(data_ts))
checkresiduals(remainder(decomposed_data))
Annees=time(data_ts_train)
ts_DataFrame =data.frame(trafic=data_ts_train,X=as.numeric(Annees))
Regression <- lm(trafic~X,data = ts_DataFrame)
tendance=predict(Regression)
Annees=as.numeric(Annees)
AnneeMoisNumeric=seq(max(Annees)+1/12,length=36,by=1/12)
tendance2=predict(Regression, newdata=data.frame(X=AnneeMoisNumeric))
ts_DataFrame$trafic_residual <- residuals(Regression)
ts_DataFrame$mois <- round(ts_DataFrame$X - trunc(ts_DataFrame$X),digit=4)
Regression2 =lm(trafic_residual~0+as.factor(mois),data=ts_DataFrame)
prediction2 =predict(Regression2)
MoisNumeric= round(AnneeMoisNumeric - trunc(AnneeMoisNumeric
),4)
Prediction3 =predict( Regression2, newdata= data.frame(mois=MoisNumeric))
ResidusRegression2=residuals(Regression2)
hist(ResidusRegression2)
1.96*sqrt(var(ResidusRegression2))
plot(acf(ResidusRegression2))
Buys_ballot_plot_tendance <- plot(data_ts,
main = "Application du modèle de Buys_Ballot",
xlab = "Années",
ylab = "Nombre de Voyageurs")
#droite de tendance
lines(Annees,tendance,col="blue",lwd=2)
#prédiction de la tendance futur
lines(AnneeMoisNumeric,tendance2,col="red")
Buys_ballot_plot <- plot(data_ts,
main = "Application du modèle de Buys_Ballot",
xlab = "Années",
ylab = "Nombre de Voyageurs")
#prédiction du modèle de Buys ballot
lines(Annees,tendance+prediction2,col="blue",lwd=2)
#Interval de confiance
polygon(c(AnneeMoisNumeric,rev(AnneeMoisNumeric)),
c(tendance2+Prediction3-1.96*sqrt(var(ResidusRegression2)),
rev(tendance2+Prediction3+1.96*sqrt(var(ResidusRegression2)))),
col="cadetblue1",border=NA)
#Prediction des valeurs
lines(AnneeMoisNumeric,tendance2+Prediction3,col="blue",lwd=2)
lines(data_ts_test,col="black",lwd=3)
Buys_ballot_plot <- plot(data_ts_test,
main = "Application du modèle de Buys_Ballot",
xlab = "Années",
ylab = "Nombre de Voyageurs")
#prédiction du modèle de Buys ballot
lines(Annees,tendance+prediction2,col="blue",lwd=2)
#Interval de confiance
polygon(c(AnneeMoisNumeric,rev(AnneeMoisNumeric)),
c(tendance2+Prediction3-1.96*sqrt(var(ResidusRegression2)),
rev(tendance2+Prediction3+1.96*sqrt(var(ResidusRegression2)))),
col="cadetblue1",border=NA)
#Prediction des valeurs
lines(AnneeMoisNumeric,tendance2+Prediction3,col="blue",lwd=2)
lines(data_ts_test,col="black",lwd=3)
library(forecast)
mean <- meanf(data_ts_train, h=8)
naivem <- naive(data_ts_train, h=8)
driftm <- rwf(data_ts_train, h=8, drif=T)
snaivem <- snaive(data_ts_train, h=8)
plot(mean, plot.conf = F, main="")
lines(naivem$mean, col=2, lty=1)
lines(driftm$mean, col=5, lty=1)
lines(snaivem$mean, col = 4, lty=1)
legend("topleft", lty=1, col=c(1,2,3,4), legend=c("Mean Method", "Naive Method", "Drif Method", "Seasonal Naive"))
#comparaison :
plot(snaivem, plot.conf = F, main="")
lines(data_ts_test, col = 6, lty=1, lwd=3)
plot(driftm, plot.conf = F, main="")
lines(data_ts_test, col = 6, lty=1, lwd=3)
print(summary(mean))
checkresiduals(mean)
accuracy(mean, data_ts_test)
print(summary(naivem))
checkresiduals(naivem)
accuracy(naivem, data_ts_test)
print(summary(driftm))
checkresiduals(driftm)
accuracy(driftm, data_ts_test)
print(summary(snaivem))
checkresiduals(snaivem)
accuracy(snaivem, data_ts_test)
fcst_se <- ses(data_ts_train, h = 8)
print(summary(fcst_se))
checkresiduals(fcst_se)
plot(fcst_se)
lines(data_ts_test, col="red")
df_se = as.data.frame(fcst_se)
predict_value_se <- df_se$`Point Forecast`
MAPE(predict_value_se, data_ts_test)*100
fit_ets <- ets(data_ts_train)
print(summary(fit_ets))
checkresiduals(fit_ets)
fcst_ets <- forecast(fit_ets, h=8)
plot(fcst_ets)
lines(data_ts_test, col="red")
df_ets = as.data.frame(fcst_ets)
predict_value_ets = df_ets$`Point Forecast`
MAPE(predict_value_ets, data_ts_test)*100
# retourne les meilleurs paramètres
# d=1 enleve la tendance
# D=1 enleve la saisonnalité
# => avoir des données stationnaires
# trace : voir les résultats
fit_arima <- auto.arima(data_ts_train, d=1, D=1, stepwise = FALSE, approximation = FALSE, trace=TRUE)
print(summary(fit_arima))
checkresiduals(fit_arima)
fcst_arima <- forecast(fit_arima, h=8)
plot(fcst_arima)
lines(data_ts_test, col='red')
df_arima = as.data.frame(fcst_arima)
predict_value_arima = df_arima$`Point Forecast`
MAPE(predict_value_arima, data_ts_test)*100
Annees=time(data_ts_train)
ts_DataFrame =data.frame(trafic=data_ts_train,X=as.numeric(Annees))
plot(fcst_se)
lines(data_ts_test, col="red")
df_se = as.data.frame(fcst_se)
predict_value_se <- df_se$`Point Forecast`
MAPE(predict_value_se, data_ts_test)*100
fcst_ets <- forecast(fit_ets, h=8)
plot(fcst_ets)
lines(data_ts_test, col="red")
df_ets = as.data.frame(fcst_ets)
predict_value_ets = df_ets$`Point Forecast`
MAPE(predict_value_ets, data_ts_test)*100
